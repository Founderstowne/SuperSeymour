<!DOCTYPE html>
<html>
<head>
    <title>SuperSeymour Bookmarklet Generator</title>
    <style>
        body {
            font-family: -apple-system, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
        }
        .bookmarklet {
            display: inline-block;
            padding: 15px 30px;
            background: linear-gradient(135deg, #0066cc, #0099ff);
            color: white;
            text-decoration: none;
            border-radius: 50px;
            font-weight: 600;
            margin: 20px 0;
        }
        textarea {
            width: 100%;
            height: 400px;
            font-family: monospace;
            font-size: 12px;
        }
        .info {
            background: #f0f0f0;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <h1>SuperSeymour Bookmarklet Generator</h1>

    <div class="info">
        <h3>How SuperSeymour Works:</h3>
        <ol>
            <li><strong>First Run:</strong> The bookmarklet loads the full code and stores it in IndexedDB</li>
            <li><strong>Subsequent Runs:</strong> Code runs from IndexedDB (no server needed)</li>
            <li><strong>Updates:</strong> Checks for new versions periodically</li>
            <li><strong>100% Private:</strong> Everything runs locally in your browser</li>
        </ol>
    </div>

    <p><strong>The Magic Bookmarklet:</strong></p>

    <a href="javascript:(function(){
        /* SuperSeymour Bookmarklet Loader v1.0 */
        if(window.SuperSeymour && window.SuperSeymour.active){
            window.SuperSeymour.toggle();
            return;
        }

        /* Check IndexedDB for cached code */
        const loadFromCache = async () => {
            try {
                const db = await new Promise((resolve, reject) => {
                    const request = indexedDB.open('SuperSeymourDB', 1);
                    request.onerror = () => reject(request.error);
                    request.onsuccess = () => resolve(request.result);
                    request.onupgradeneeded = (e) => {
                        const db = e.target.result;
                        if (!db.objectStoreNames.contains('code')) {
                            db.createObjectStore('code');
                        }
                    };
                });

                const tx = db.transaction(['code'], 'readonly');
                const store = tx.objectStore('code');
                const code = await new Promise((resolve) => {
                    const request = store.get('main');
                    request.onsuccess = () => resolve(request.result);
                });

                db.close();
                return code;
            } catch(e) {
                console.log('Cache miss:', e);
                return null;
            }
        };

        const saveToCache = async (code) => {
            try {
                const db = await new Promise((resolve, reject) => {
                    const request = indexedDB.open('SuperSeymourDB', 1);
                    request.onerror = () => reject(request.error);
                    request.onsuccess = () => resolve(request.result);
                    request.onupgradeneeded = (e) => {
                        const db = e.target.result;
                        if (!db.objectStoreNames.contains('code')) {
                            db.createObjectStore('code');
                        }
                    };
                });

                const tx = db.transaction(['code'], 'readwrite');
                const store = tx.objectStore('code');
                store.put(code, 'main');
                await tx.complete;
                db.close();
            } catch(e) {
                console.log('Cache save failed:', e);
            }
        };

        const init = async () => {
            /* Try cache first */
            let code = await loadFromCache();

            if (!code) {
                /* First run - show welcome */
                const consent = confirm('Welcome to SuperSeymour! âœ¨\n\nThis will enhance any website with:\nâ€¢ Dark mode\nâ€¢ Reader mode\nâ€¢ Ad blocking\nâ€¢ And more!\n\nEverything runs locally in your browser.\nNo data is sent anywhere.\n\nInstall SuperSeymour?');

                if (!consent) return;

                /* For now, use inline mini version */
                code = `(function(){
                    if(window.SuperSeymour && window.SuperSeymour.active) {
                        window.SuperSeymour.toggle();
                        return;
                    }

                    window.SuperSeymour = {
                        active: true,
                        toggle: function() {
                            const orb = document.querySelector('#superseymour-orb');
                            if(orb) {
                                orb.remove();
                                this.active = false;
                            } else {
                                this.init();
                            }
                        },
                        init: function() {
                            /* Create orb */
                            const orb = document.createElement('div');
                            orb.id = 'superseymour-orb';
                            orb.innerHTML = 'âš¡';
                            orb.style.cssText = 'position:fixed;bottom:30px;right:30px;width:60px;height:60px;background:linear-gradient(135deg,#0066cc,#0099ff);border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:30px;cursor:pointer;z-index:2147483647;box-shadow:0 4px 20px rgba(0,102,204,0.4);transition:all 0.3s ease;';

                            orb.onclick = () => {
                                alert('SuperSeymour Menu\\n\\nðŸ“– Reader Mode\\nðŸŒ™ Dark Mode\\nâš¡ Speed Mode\\nðŸ§˜ Zen Mode\\n\\n(Full version coming soon!)');
                            };

                            document.body.appendChild(orb);

                            /* Show notification */
                            const notify = document.createElement('div');
                            notify.innerHTML = 'SuperSeymour Ready - Click orb for menu';
                            notify.style.cssText = 'position:fixed;top:20px;right:20px;background:linear-gradient(135deg,#0066cc,#0099ff);color:white;padding:12px 20px;border-radius:8px;z-index:2147483647;animation:slideIn 0.5s ease;';
                            document.body.appendChild(notify);
                            setTimeout(() => notify.remove(), 3000);

                            this.active = true;
                        }
                    };

                    window.SuperSeymour.init();
                })();`;

                /* Save to cache */
                await saveToCache(code);
            }

            /* Execute code */
            try {
                eval(code);
            } catch(e) {
                console.error('SuperSeymour error:', e);
            }
        };

        init();
    })();" class="bookmarklet">âš¡ SuperSeymour (Drag to Bookmarks)</a>

    <div class="info">
        <h3>Installation:</h3>
        <ol>
            <li>Drag the button above to your bookmarks bar</li>
            <li>Click it on any website to activate SuperSeymour</li>
            <li>Click the orb to see available features</li>
        </ol>
    </div>

    <h3>Bookmarklet Code (for developers):</h3>
    <textarea id="code" readonly>
// This is the minified bookmarklet code above
// It includes:
// 1. IndexedDB caching
// 2. First-run consent
// 3. Basic orb UI
// 4. Toggle functionality
    </textarea>

    <script>
        // Show the actual bookmarklet code in the textarea
        const link = document.querySelector('.bookmarklet');
        const code = decodeURIComponent(link.href.replace('javascript:', ''));
        document.getElementById('code').value = code;
    </script>
</body>
</html>